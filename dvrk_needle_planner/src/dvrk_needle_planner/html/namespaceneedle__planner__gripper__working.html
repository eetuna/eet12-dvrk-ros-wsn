<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>My Project: needle_planner_gripper_working Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Namespace&#160;List</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">needle_planner_gripper_working Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classneedle__planner__gripper__working_1_1needle__planner.html">needle_planner</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab7510c7195b9340785ac2462590514a5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab7510c7195b9340785ac2462590514a5"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>debug_needle_print</b> = bool('')</td></tr>
<tr class="separator:ab7510c7195b9340785ac2462590514a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af85ce4c04c2345af91bfbeceae89ff42"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af85ce4c04c2345af91bfbeceae89ff42"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>DEFAULT_NEEDLE_GRASP_DEPTH</b> = 0.005</td></tr>
<tr class="separator:af85ce4c04c2345af91bfbeceae89ff42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab38003ffe0f5699a6fbaa169edb0ef0e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab38003ffe0f5699a6fbaa169edb0ef0e"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>GRASP_W_NEEDLE_POSITIVE_GRIPPER_Y</b> = 1</td></tr>
<tr class="separator:ab38003ffe0f5699a6fbaa169edb0ef0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf730c27701872c4beef8953b283dd99"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adf730c27701872c4beef8953b283dd99"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>GRASP_W_NEEDLE_NEGATIVE_GRIPPER_Y</b> = -1</td></tr>
<tr class="separator:adf730c27701872c4beef8953b283dd99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c07e2dc387e380f4266777ec5cb7e76"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2c07e2dc387e380f4266777ec5cb7e76"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>GRASP_W_NEEDLE_POSITIVE_GRIPPER_Z</b> = 1</td></tr>
<tr class="separator:a2c07e2dc387e380f4266777ec5cb7e76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55bb988a1602b62ce9e81fd7e9ed561e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a55bb988a1602b62ce9e81fd7e9ed561e"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>GRASP_W_NEEDLE_NEGATIVE_GRIPPER_Z</b> = -1</td></tr>
<tr class="separator:a55bb988a1602b62ce9e81fd7e9ed561e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cfd8d7c550e4935a9b4c7ae0b10dc28"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5cfd8d7c550e4935a9b4c7ae0b10dc28"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>DEFAULT_NEEDLE_RADIUS</b> = 0.0254</td></tr>
<tr class="separator:a5cfd8d7c550e4935a9b4c7ae0b10dc28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a537a90685803b39d9ad14a2fb279a9c4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a537a90685803b39d9ad14a2fb279a9c4"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>DEFAULT_NEEDLE_AXIS_HT</b> = DEFAULT_NEEDLE_RADIUS/math.sqrt(2.0)</td></tr>
<tr class="separator:a537a90685803b39d9ad14a2fb279a9c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a684a4224a78b6a7cbaf8a448184b1d74"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a684a4224a78b6a7cbaf8a448184b1d74"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>NSAMPS_DRIVE_PLAN</b> = 21</td></tr>
<tr class="separator:a684a4224a78b6a7cbaf8a448184b1d74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adeebec3c689e1d7dccd8307a037cf9fd"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adeebec3c689e1d7dccd8307a037cf9fd"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>DEFAULT_PHI_GRAB</b> = 0.0</td></tr>
<tr class="separator:adeebec3c689e1d7dccd8307a037cf9fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">library to compute gripper poses to perform needle driving
# main fnc is: def compute_needle_drive_gripper_affines(...)
# need to specify tissue properties (w/rt camera frame)
# Also specify grasp transform (or accept the default) and choose which arm (or accept default=PSM1)
# provide tissue entrance pt, exit pt and surface normal (w/rt camera frame)
# Get back a vector of affines of corresponding gripper affines, wrt camera frame
# (really, inputs/outputs w/rt whatever frame is of interest, but presumably camera frame)


# NEEDLE-DRIVE ASSUMPTIONS:  
# this code assumes needle driving will be in a circular arc about the needle center
# The needle center is defined as the center of the circle that contains the needle semi-circle
#  This is defined as the origin of the needle frame. The z-axis of the needle frame, bvec_needle,
# is defined perpendicular to the needle plane, with positive direction corresponding to
# needle driving with the tip leading (a requirement) corresponds to positive rotation about
# the needle z axis.
# at present, this code assumes rotation of the needle during driving is about 
# an axis parallel to the tissue surface, i.e. needle z-axis is perpendicular to tissue normal
#  (this is not required, but common)

# NEEDLE GRASP ASSUMPTIONS:
# this code does not care which arm is used; all gripper affines are computed to achieve
# a needle-drive path; not arm IK is performed here

# one can choose where on the circumference of the needle to grab it--but pragmatically,
# one will grab the needle as close to the needle tail as possible (i.e., as far from the 
# needle point as possible), so as to minimize requirements for re-grasping during needle driving
# The choice of where along the circumference to grab the needle is phi_grab_
# Define this as: phi_grab_=0 means to grab the needle in the center of its arc;
# phi_grab_ = +pi/2 means to grab the needle at its tail (should make this pi/2- half_gripper_width
#   to get a full grasp).  phi_grab_ = -pi/2 would mean to grab the gripper tip (not useful for
#  needle driving).

# a common grasp strategy is to hold the needle such that its plane is perpendicular to
# the gripper z-axis, i.e. the needle bvec_needle = +/- bvec_gripper; this is not required in general,
# but it is the default grasp pose for this code

# One must choose the contact points on the gripper where the needle will be held.  The
# default assumption for this code is that the needle will be grabbed half-way between the
# gripper tips and the gripper-jaw joint.  This is changeable via a "set" call.

# With the constraint that the needle plane is perpendicular to the gripper bvec_gripper, there
# are still 4 variations: bvec_needle = +/- bvec_gripper, and needle origin along positive or
# negative gripper y-axis (tvec_gripper).  These may by: 1) selecting direction of bvec_needle
#  (e.g., parallel or antiparallel to bvec_gripper), and 2) choosing "needle_plus_y" or "needle_ninus_y".
# For bvec_needle parallel or antiparallel to bvec_gripper, "needle_plus_y" means that the needle 
# origin will lie on the positive tvec_gripper axis; "needle_minus_y" means that the needle lies on
# the negative tvec_gripper axis.
# More generally, the needle z-axis, bvec_needle, does not have to be parallel or antiparallel to
# the gripper bvec_gripper.  In this case, the needle origin will not lie on the gripper tvec_gripper
# axis.  However, the needle origin would lie in either the positive-y half space of the gripper frame
# or the negative-y half-space of the gripper frame, and the designation "needle_plus_y" would
# still be meaningful.  However, this does not cover the special case where the plane of the needle
# contains bvec_gripper.  In this case, the needle origin will lie at y/gripper = 0.  If this case
# This case is not covered here.


# a common grasp is to have the needle surface-tangent parallel or antiparallel to the gripper x axis at 
#  the grasp location ,i.e. the needle extends out perpendicular to the jaws, i.e.
#  needle tangent  is perpendicular to gripper bvec
# it is also common to have the needle z-axis parallel to or antiparallel to the gripper z axis:
# bvec_needle || bvec_gripper, or bvec_needle || -bvec_gripper
#  That is, the needle origin lies along the (plus or minus) gripper y axis.
# Define the needle-frame x-axis as pointing from needle center (origin) towards needle tip
# Approximately, if grab the needle as far as possible from the needle tip, 
# and this grasp has needle bvec_needle || +/- bvec_gripper, then the needle tip 
# tip would also lie along the</pre> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
